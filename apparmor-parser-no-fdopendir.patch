diff -urN apparmor-parser-2.0.org/parser_include.c apparmor-parser-2.0/parser_include.c
--- apparmor-parser-2.0.org/parser_include.c	2006-10-12 18:56:46.000000000 +0200
+++ apparmor-parser-2.0/parser_include.c	2006-12-13 00:33:28.105942250 +0100
@@ -393,7 +393,7 @@
 	}
 
 	if (S_ISDIR(my_stat.st_mode)) {
-		DIR *dir = fdopendir(fileno(newf));
+		DIR *dir = opendir(buf);
 		struct dirent *dirent;
 		if (!dir) {
 			retval = 1;
